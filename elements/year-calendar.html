<!--
Displays an entire year in a 4x3 grid.
-->

<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../../quetzal/elements/quetzal-calendar-month-with-headings.html">

<polymer-element name="year-calendar" attributes="year">

<template>
  
  <style>
  :host {
    display: inline-block;
  }

  #monthGrid {
    display: table;
    width: 100%;
  }

  .monthsRow {
    display: table-row;
  }
  .monthsRow > * {
    display: table-cell;
    padding-bottom: 0.75em;
    padding-right: 1em;
  }

  #daysOfWeekHeader > quetzal-days-of-week {
    font-size: 0.8em;
  }

  /* Override generic calendar styling */
  quetzal-days-of-week ^ .dayOfWeek {
    padding: 0 1px !important;
  }
  quetzal-days-of-week ^ .dayOfWeek.weekend {
    color: #aaa !important;
  }

  quetzal-calendar-month-with-headings ^ quetzal-month-and-year {
    color: darkred;
    text-align: left !important;
  }
  quetzal-calendar-month-with-headings ^ quetzal-month-and-year ^ #year {
    display: none;
  }

  /* Suppress days of week headers on individual months  */
  quetzal-calendar-month-with-headings ^ quetzal-days-of-week {
    display: none !important;
  }

  quetzal-calendar-day {
    font-weight: bold;
    padding: 2px 0px !important;
  }
  quetzal-calendar-day.today {
    color: inherit !important;
  }
  quetzal-calendar-day.weekend.insideMonth {
    color: #aaa !important;
  }
  </style>

  <h1 id="year"></h1>
  <div id="monthGrid">
    <div class="monthsRow" id="daysOfWeekHeader">
      <quetzal-days-of-week format="namesAbbr"></quetzal-days-of-week>
      <quetzal-days-of-week format="namesAbbr"></quetzal-days-of-week>
      <quetzal-days-of-week format="namesAbbr"></quetzal-days-of-week>
    </div>
    <div class="monthsRow">
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
    </div>
    <div class="monthsRow">
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
    </div>
    <div class="monthsRow">
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
    </div>
    <div class="monthsRow">
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings></quetzal-calendar-month-with-headings>
    </div>
  </div>

</template>

<script>
Polymer( "year-calendar", {

  applyAuthorStyles: true,

  ready: function() {
    if ( this.year == null ) {
      var date = new Date();
      this.year = date.getFullYear();
    }
  },

  get months() {
    return this.shadowRoot.querySelectorAll( "quetzal-calendar-month-with-headings" ).array();
  },

  yearChanged: function() {
    this._refresh();
  },

  _refresh: function() {
    var year = this.year;
    this.$.year.textContent = year;
    this.months.forEach( function( month, index ) {
      var date = new Date();
      date.setFullYear( year );
      date.setMonth( index );
      date.setDate( 1 );
      month.date = date;
    });
  }

});
</script>

</polymer-element>