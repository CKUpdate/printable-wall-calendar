<!--
Displays an entire year in a 4x3 grid.
-->

<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../../quetzal/elements/quetzal-calendar-month-with-headings.html">

<polymer-element name="year-calendar" attributes="year">

<template>
  <style>
  #monthGrid {
    display: table;
  }

  .monthColumn {
    display: table-cell;
  }

  /* Override generic calendar styling */
  quetzal-calendar-month-with-headings {
    /*display: table;*/
    display: block;
    margin-bottom: 1em;
    margin-right: 1em;
  }
  quetzal-calendar-month-with-headings ^ quetzal-month-and-year {
    color: darkred;
    text-align: left !important;
  }
  quetzal-calendar-month-with-headings ^ quetzal-month-and-year ^ #year {
    display: none;
  }
  .dayOfWeek.weekend {
    color: #aaa !important;
  }
  quetzal-calendar-week.outsideMonth {
    display: table-row !important;
    visibility: hidden;
  }
  quetzal-calendar-day {
    font-weight: bold;
    padding: 2px 3px !important;
  }
  quetzal-calendar-day.today {
    color: inherit !important;
  }
  quetzal-calendar-day.weekend.insideMonth {
    color: #aaa !important;
  }

  /* Only show headings for first three months */
  quetzal-calendar-month-with-headings ^ quetzal-days-of-week {
    display: none !important;
  }
  #month1 ^ quetzal-days-of-week,
  #month2 ^ quetzal-days-of-week,
  #month3 ^ quetzal-days-of-week {
    display: table-header-group !important;
  }
  </style>
  <h1 id="year"></h1>
  <div id="monthGrid">
    <div class="monthColumn">
      <quetzal-calendar-month-with-headings id="month1" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month4" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month7" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month10" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
    </div>
    <div class="monthColumn">
      <quetzal-calendar-month-with-headings id="month2" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month5" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month8" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month11" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
    </div>
    <div class="monthColumn">
      <quetzal-calendar-month-with-headings id="month3" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month6" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month9" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
      <quetzal-calendar-month-with-headings id="month12" daysOfWeekFormat="namesAbbr"></quetzal-calendar-month-with-headings>
    </div>
  </div>
</template>

<script>
Polymer( "year-calendar", {

  applyAuthorStyles: true,

  ready: function() {
    if ( this.year == null ) {
      var date = new Date();
      this.year = date.getFullYear();
    }
  },

  get months() {
    // return this.shadowRoot.querySelectorAll( "quetzal-calendar-month" ).array();
    return [
      this.$.month1,
      this.$.month2,
      this.$.month3,
      this.$.month4,
      this.$.month5,
      this.$.month6,
      this.$.month7,
      this.$.month8,
      this.$.month9,
      this.$.month10,
      this.$.month11,
      this.$.month12
    ]
  },

  yearChanged: function() {
    this._refresh();
  },

  _refresh: function() {
    var year = this.year;
    this.$.year.textContent = year;
    this.months.forEach( function( month, index ) {
      var date = new Date();
      date.setFullYear( year );
      date.setMonth( index );
      date.setDate( 1 );
      month.date = date;
    });
  }

});
</script>

</polymer-element>